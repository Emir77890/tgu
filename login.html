<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f4f4; }
    header { background: #222; color: #fff; padding: 10px; display: flex; justify-content: space-around; }
    header button { background: #444; color: white; border: none; padding: 10px 15px; cursor: pointer; border-radius: 5px; }
    header button:hover { background: #666; }
    .section { display: none; padding: 20px; }
    .active { display: block; }
    #chatBox { border: 1px solid #ccc; height: 300px; overflow-y: auto; padding: 10px; background: #fff; }
    #chatInput { width: 80%; padding: 8px; }
    #sendBtn { padding: 8px 15px; }
    .message { margin: 5px 0; padding: 5px 10px; background: #eee; border-radius: 5px; }
    #profile img { width: 100px; border-radius: 50%; margin-bottom: 10px; display: block; }
    #shopItems { margin-top: 10px; }
    .item { border: 1px solid #aaa; padding: 10px; margin: 5px 0; background: #fff; }
    .buyBtn { background: green; color: white; border: none; padding: 5px 10px; margin-top: 5px; cursor: pointer; border-radius: 5px; }
    .buyBtn:hover { background: darkgreen; }
  </style>
</head>
<body>

<header>
  <button onclick="showSection('chat')">–ß–∞—Ç</button>
  <button onclick="showSection('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
  <button onclick="showSection('shop')">–ú–∞–≥–∞–∑–∏–Ω</button>
  <a href="register.htm">
    <button>–ù–∞–π—Ç–∏ –¥—Ä—É–≥–∞</button>
  </a>
  <!-- –ß–∞—Ç —Å –∞–¥–º–∏–Ω–æ–º -->
<div id="admin-chat" style="display:none; border:1px solid #ccc; padding:10px; margin-top:20px;">
  <h3>–ß–∞—Ç —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</h3>
  <div id="admin-messages" style="height:200px; overflow-y:auto; border:1px solid #999; margin-bottom:10px;"></div>
  <input type="text" id="admin-input" placeholder="–ù–∞–ø–∏—à–∏ –∞–¥–º–∏–Ω—É...">
  <button id="admin-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>
</header>

<section>
    
</section>

<!-- –ß–∞—Ç -->
<div id="chat" class="section active">
  <h2>–ß–∞—Ç</h2>
  <div id="chatBox"></div>
  <input type="text" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
  <button id="sendBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>


<!-- –ü—Ä–æ—Ñ–∏–ª—å -->
<div id="profile" class="section">
  <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
  <img id="avatar" src="https://via.placeholder.com/100" alt="–ê–≤–∞—Ç–∞—Ä">
  <input type="file" id="avatarInput" accept="image/*" onchange="setAvatar(event)">
  <p><b>–ù–∏–∫–Ω–µ–π–º:</b> <span id="nickname">–ò–≥—Ä–æ–∫</span></p>
  <p><b>–í–æ–∑—Ä–∞—Å—Ç:</b> <span id="age">–ù–µ —É–∫–∞–∑–∞–Ω</span></p>
  <input type="text" id="ageInput" placeholder="–£–∫–∞–∂–∏ –≤–æ–∑—Ä–∞—Å—Ç">
  <button onclick="saveAge()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç</button>
  <p><b>–ë–∞–ª–∞–Ω—Å:</b> <span id="balance">1000</span> –º–æ–Ω–µ—Ç</p>
</div>

<!-- –ú–∞–≥–∞–∑–∏–Ω -->
<div id="shop" class="section">
  <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
  <input type="text" id="itemName" placeholder="–ß—Ç–æ –ø—Ä–æ–¥–∞–µ—à—å?">
  <input type="number" id="itemPrice" placeholder="–¶–µ–Ω–∞">
  <button onclick="addItem()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
  <div id="shopItems"></div>
</div>

<script>
  let balance = parseInt(localStorage.getItem("balance")) || 1000;

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  // ===== –ß–∞—Ç =====
  function renderChat() {
    let chatBox = document.getElementById('chatBox');
    chatBox.innerHTML = "";
    let messages = JSON.parse(localStorage.getItem("chatMessages")) || [];
    messages.forEach(msg => {
      let div = document.createElement('div');
      div.className = "message";
      div.innerText = msg;
      chatBox.appendChild(div);
    });
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  document.getElementById('sendBtn').onclick = function() {
    let input = document.getElementById('chatInput');
    let msg = input.value.trim();
    if (msg !== "") {
      let messages = JSON.parse(localStorage.getItem("chatMessages")) || [];
      messages.push("–¢—ã: " + msg);
      localStorage.setItem("chatMessages", JSON.stringify(messages));
      renderChat();
      input.value = "";
    }
  }

  // ===== –ü—Ä–æ—Ñ–∏–ª—å =====
  function saveAge() {
    let age = document.getElementById('ageInput').value;
    if (age) {
      document.getElementById('age').innerText = age;
      localStorage.setItem("age", age);
      document.getElementById('ageInput').value = "";
    }
  }

  function setAvatar(event) {
    let reader = new FileReader();
    reader.onload = function(e) {
      document.getElementById('avatar').src = e.target.result;
      localStorage.setItem("avatar", e.target.result);
    }
    reader.readAsDataURL(event.target.files[0]);
  }

  // ===== –ú–∞–≥–∞–∑–∏–Ω =====
  function addItem() {
    let name = document.getElementById('itemName').value;
    let price = document.getElementById('itemPrice').value;
    if (name && price) {
      let items = JSON.parse(localStorage.getItem("shopItems")) || [];
      items.push({name, price});
      localStorage.setItem("shopItems", JSON.stringify(items));
      renderShop();
      document.getElementById('itemName').value = "";
      document.getElementById('itemPrice').value = "";
    }
  }

  function buyItem(price, btn) {
    if (balance >= price) {
      balance -= price;
      localStorage.setItem("balance", balance);
      document.getElementById('balance').innerText = balance;
      btn.innerText = "‚úÖ –ö—É–ø–ª–µ–Ω–æ";
      btn.disabled = true;
    } else {
      alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
    }
  }

  function renderShop() {
    let shopBox = document.getElementById('shopItems');
    shopBox.innerHTML = "";
    let items = JSON.parse(localStorage.getItem("shopItems")) || [];
    items.forEach(item => {
      let div = document.createElement('div');
      div.className = "item";
      div.innerHTML = "üì¢ –ò–≥—Ä–æ–∫ –ø—Ä–æ–¥–∞–µ—Ç: <b>" + item.name + "</b> –∑–∞ <b>" + item.price + "</b> –º–æ–Ω–µ—Ç" +
                      "<br><button class='buyBtn' onclick='buyItem(" + item.price + ", this)'>–ö—É–ø–∏—Ç—å</button>";
      shopBox.appendChild(div);
    });
  }

  // ===== –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ =====
  window.onload = function() {
    if (localStorage.getItem("avatar")) {
      document.getElementById('avatar').src = localStorage.getItem("avatar");
    }
    if (localStorage.getItem("age")) {
      document.getElementById('age').innerText = localStorage.getItem("age");
    }
    if (localStorage.getItem("balance")) {
      document.getElementById('balance').innerText = localStorage.getItem("balance");
      balance = parseInt(localStorage.getItem("balance"));
    }
    renderShop();
    renderChat();
  }
</script>
<script>
  
  // ===== –ó–í–û–ù–û–ö =====
  const phoneInput = document.getElementById("phone");
  const savePhoneBtn = document.getElementById("savePhone");
  const savedNumber = document.getElementById("savedNumber");

  if (localStorage.getItem("phoneNumber")) {
    const number = localStorage.getItem("phoneNumber");
    savedNumber.textContent = "–¢–≤–æ–π –Ω–æ–º–µ—Ä: " + number;
    phoneInput.value = number;
    addMessage("–ú–æ–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –Ω–æ–º–µ—Ä: " + number);
  }

  savePhoneBtn.addEventListener("click", () => {
    const number = phoneInput.value.trim();
    if (number) {
      localStorage.setItem("phoneNumber", number);
      savedNumber.textContent = "–¢–≤–æ–π –Ω–æ–º–µ—Ä: " + number;
      addMessage("–ú–æ–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –Ω–æ–º–µ—Ä: " + number);
      alert("üìå –ù–æ–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω!");
    }
  });
</script>

  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
    #chat-box { border: 1px solid #ccc; background: white; height: 300px; padding: 10px; overflow-y: auto; margin-bottom: 10px; }
    #message-input { width: 70%; padding: 10px; }
    #send-btn { padding: 10px; }
    #phone-box, #register-box, #profile-box { margin-top: 20px; padding: 15px; background: white; border: 1px solid #ccc; }
    input { padding: 8px; margin: 5px 0; width: 200px; }
    button { padding: 8px 12px; }
    #status { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>

  



  <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
  <div id="profile-box" style="display:none;">
    <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
    <p><b>–ù–∏–∫:</b> <span id="prof-nick"></span></p>
    <p><b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> <span id="prof-phone"></span></p>
    <button id="logout-btn">–í—ã–π—Ç–∏</button>
  </div>

  



  <script>
    const chatBox = document.getElementById("chat-box");
    const messageInput = document.getElementById("message-input");
    const sendBtn = document.getElementById("send-btn");
    const phoneInput = document.getElementById("phone-input");
    const connectBtn = document.getElementById("connect-btn");
    const status = document.getElementById("status");

    const regBox = document.getElementById("register-box");
    const profBox = document.getElementById("profile-box");
    const regBtn = document.getElementById("reg-btn");
    const logoutBtn = document.getElementById("logout-btn");

    const profNick = document.getElementById("prof-nick");
    const profPhone = document.getElementById("prof-phone");

    let currentChatNumber = null;
    let currentUser = null;

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
    if(localStorage.getItem("user")) {
      currentUser = JSON.parse(localStorage.getItem("user"));
      showProfile();
    }

    function showProfile() {
      regBox.style.display = "none";
      profBox.style.display = "block";
      profNick.textContent = currentUser.nick;
      profPhone.textContent = currentUser.phone;
    }

    function addMessage(sender, text) {
      chatBox.innerHTML += <p><b>${sender}:</b> ${text}</p>;
      chatBox.scrollTop = chatBox.scrollHeight;
    }

   

    // –í—ã—Ö–æ–¥
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("user");
      currentUser = null;
      regBox.style.display = "block";
      profBox.style.display = "none";
    });

   

  </script>

<script>
  // ===== –ß–∞—Ç —Å –∞–¥–º–∏–Ω–æ–º =====
  const adminChat = document.getElementById("admin-chat");
  const adminMessages = document.getElementById("admin-messages");
  const adminInput = document.getElementById("admin-input");
  const adminSend = document.getElementById("admin-send");

  // –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ ‚Äî –≤–∫–ª—é—á–∏–º —á–∞—Ç —Å –∞–¥–º–∏–Ω–æ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  function openAdminChat(username) {
    adminChat.style.display = "block";
    addAdminMessage("–ê–¥–º–∏–Ω: –ü—Ä–∏–≤–µ—Ç, " + username + "! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?");
  }

  function addAdminMessage(text) {
    adminMessages.innerHTML += <p>${text}</p>;
    adminMessages.scrollTop = adminMessages.scrollHeight;
  }

  adminSend.addEventListener("click", () => {
    const msg = adminInput.value.trim();
    if (msg !== "") {
      addAdminMessage("–¢—ã: " + msg);
      adminInput.value = "";
      // –ó–¥–µ—Å—å –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤—Å–µ –Ω–∏–∫–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ!)
    }
  });
</script>

  <style>
    body { font-family: Arial, sans-serif; background: #f3f3f3; margin: 20px; }
    h2 { text-align: center; }
    #messages { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; margin-bottom: 10px; background: #fff; border-radius: 10px; }
    .msg { margin: 5px 0; padding: 5px; border-bottom: 1px solid #eee; }
    input, button { padding: 10px; }
    button { background: #333; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>–ß–∞—Ç —Å –∞–¥–º–∏–Ω–æ–º</h2>
  <div id="messages"></div>
  <div>
    <input type="text" id="msgInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>

  <script>
    let messages = JSON.parse(localStorage.getItem("messages")) || [];
    let msgBox = document.getElementById("messages");
    let currentUser = localStorage.getItem("currentUser") || "–ò–≥—Ä–æ–∫";

    function renderMessages() {
      msgBox.innerHTML = "";
      messages.forEach(m => {
        let div = document.createElement("div");
        div.className = "msg";
        div.textContent = m.username + ": " + m.text;
        msgBox.appendChild(div);
      });
      msgBox.scrollTop = msgBox.scrollHeight; // –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
    }
    renderMessages();

    function sendMessage() {
      let input = document.getElementById("msgInput");
      if (!input.value) return;

      let msg = { username: currentUser, text: input.value, time: Date.now() };
      messages.push(msg);
      localStorage.setItem("messages", JSON.stringify(messages));

      input.value = "";
      renderMessages();
    }

    // –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
    setInterval(() => {
      messages = JSON.parse(localStorage.getItem("messages")) || [];
      renderMessages();
    }, 2000);
  </script>
</body>
</html>